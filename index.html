<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Portal interno de comunicações e serviços do Grupo Chavantes - Hospital Waldemar Tebaldi">
    <title>Portal Interno | Grupo Chavantes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-bg: #1e2338;
            --secondary-bg: #2a304a;
            --card-bg: #1a1e2d;
            --button-bg: #008FFB;
            --button-hover: #0077CC;
            --text-primary: #ffffff;
            --text-secondary: #b0b3c5;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            --transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
            --success-color: #0077CC;
            --warning-color: #0077CC;
            --danger-color: #0077CC;
            --header-height: 80px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: var(--primary-bg);
            color: var(--text-primary);
            font-family: 'Segoe UI', 'Roboto', system-ui, -apple-system, sans-serif;
            margin: 0;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-image:
                radial-gradient(circle at 10% 20%, rgba(0, 143, 251, 0.08) 0%, transparent 20%),
                linear-gradient(to bottom, rgba(0,0,0,0.1) 0%, transparent 100px);
            opacity: 0; /* Para efeito de carregamento suave */
            transition: opacity 0.5s ease-in-out;
        }

        .container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }

        header {
            background-color: var(--secondary-bg);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 50px;
            height: 50px;
            border-radius: 4px;
            overflow: hidden;
            flex-shrink: 0;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .header-text {
            display: flex;
            flex-direction: column;
        }

        h1 {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
            line-height: 1.3;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-top: 3px;
            font-weight: 400;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--button-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .main-content {
            padding: 30px 0;
            flex-grow: 1; /* Garante que o main ocupe o espaço disponível */
        }

        .welcome-section {
            background: linear-gradient(135deg, rgba(0, 143, 251, 0.1) 0%, transparent 100%);
            padding: 25px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .welcome-title {
            font-size: 1.5rem;
            margin-bottom: 10px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .welcome-text {
            color: var(--text-secondary);
            max-width: 800px;
            line-height: 1.6;
        }

        .services-section {
            margin-top: 40px;
        }

        .section-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-primary); /* Garante cor do título */
        }

        .section-title i {
            color: var(--button-bg);
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 20px;
        }

        .service-card {
            background-color: var(--secondary-bg);
            border-radius: var(--border-radius);
            overflow: hidden;
            transition: var(--transition);
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255,255,255,0.05);
            display: flex;
            flex-direction: column;
        }

        .service-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

        .service-icon {
            background-color: var(--button-bg);
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
        }

        .service-content {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .service-title {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .service-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 15px;
            flex-grow: 1;
        }

        .service-link {
            display: inline-block;
            padding: 8px 15px;
            background-color: rgba(0, 143, 251, 0.1);
            color: var(--button-bg);
            border-radius: 4px;
            text-decoration: none;
            font-size: 0.85rem;
            font-weight: 500;
            transition: var(--transition);
            text-align: center;
            margin-top: auto; /* Empurra o link para o final do card */
        }

        .service-link:hover {
            background-color: rgba(0, 143, 251, 0.2);
        }

        .service-card.compliance .service-icon {
            background-color: var(--success-color);
        }

        .service-card.emergency .service-icon {
            background-color: var(--danger-color);
        }

        .service-card.documents .service-icon {
            background-color: var(--warning-color);
        }

        .quick-links {
            margin-top: 40px;
        }

        .links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 15px;
        }

        .quick-link {
            background-color: var(--secondary-bg);
            padding: 15px;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: var(--text-primary);
            transition: var(--transition);
            border: 1px solid rgba(255,255,255,0.05);
        }

        .quick-link:hover {
            background-color: rgba(255,255,255,0.05);
            transform: translateY(-2px); /* Leve efeito ao passar o mouse */
        }

        .quick-link i {
            color: var(--button-bg);
            font-size: 1.2rem;
        }

        .quick-link span {
            font-size: 0.9rem;
        }

        footer {
            background-color: var(--secondary-bg);
            padding: 20px 0;
            margin-top: 50px;
            border-top: 1px solid rgba(255,255,255,0.05);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .footer-text {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .footer-links {
            display: flex;
            gap: 15px;
        }

        .footer-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.8rem;
            transition: var(--transition);
        }

        .footer-link:hover {
            color: var(--button-bg);
        }

        /* --- ESTILOS PARA SEÇÃO DE ANÚNCIOS --- */
        .announcements-section {
            margin-top: 30px;
            margin-bottom: 40px;
        }

        .announcement-card {
            background-color: var(--secondary-bg);
            padding: 25px;
            border-radius: var(--border-radius);
            border: 1px solid rgba(255,255,255,0.05);
            box-shadow: var(--box-shadow);
            position: relative; /* Necessário para posicionar o botão fechar */
            padding-right: 50px; /* Espaço para o botão fechar */
            margin-bottom: 15px; /* Espaço antes da paginação */
        }

         .announcement-card h4 {
            font-size: 1.2rem;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-right: 25px; /* Garante espaço para não sobrepor o botão fechar */
        }

        .announcement-card p,
        .announcement-card ul {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.7;
            margin-bottom: 15px;
        }

        .announcement-card ul {
            list-style: none;
            padding-left: 0;
        }

        .announcement-card li {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .announcement-card li::before {
            content: '•';
            color: var(--button-bg);
            position: absolute;
            left: 0;
            top: -1px;
            font-size: 1.2rem;
        }

        .announcement-card .urgent-contact {
            font-weight: 500;
            color: var(--text-primary);
            background-color: rgba(0, 143, 251, 0.1);
            padding: 10px 15px;
            border-radius: 4px;
            display: inline-block;
            margin-top: 5px;
        }

        /* Botão Fechar (X) */
        .close-announcement {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.3rem;
            cursor: pointer;
            padding: 5px;
            line-height: 1;
            transition: color 0.2s ease;
        }

        .close-announcement:hover {
            color: var(--text-primary);
        }

        /* Paginação */
        .announcement-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
        }

        .pagination-button {
            background-color: var(--secondary-bg);
            border: 1px solid rgba(255,255,255,0.1);
            color: var(--text-primary);
            border-radius: 50%; /* Botões redondos */
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .pagination-button:hover:not(:disabled) {
            background-color: var(--button-bg);
            color: white;
        }

        .pagination-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background-color: var(--card-bg); /* Cor de fundo mais escura para desabilitado */
        }

        #announcement-page-indicator {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* Animação Sutil ao trocar anúncio (opcional) */
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }

        #announcements-container .announcement-card {
          animation: fadeIn 0.4s ease-out;
        }
        /* --- FIM DOS ESTILOS DE ANÚNCIOS --- */


        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .user-info {
                margin-top: 10px;
                align-self: flex-end;
            }

            .services-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }

            .welcome-section, .announcement-card { /* Aplica padding responsivo ao anúncio também */
                padding: 20px;
                padding-right: 45px; /* Ajusta padding direito para botão fechar em telas menores */
            }
             .announcement-card h4 {
                 padding-right: 20px;
             }


            .links-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); /* Ajusta links rápidos */
            }
        }

        @media (max-width: 480px) {
            body {
                font-size: 15px; /* Ajusta fonte base para telas menores */
            }

            h1 {
                font-size: 1.2rem;
            }
            .subtitle {
                font-size: 0.8rem;
            }
            .welcome-title {
                font-size: 1.3rem;
            }
            .announcement-card h4 {
                font-size: 1.1rem;
            }
            .section-title {
                font-size: 1.2rem;
            }
            .service-title {
                 font-size: 1rem;
            }

            .services-grid, .links-grid {
                grid-template-columns: 1fr; /* Coluna única para cards e links */
            }

             .welcome-section, .announcement-card {
                padding: 15px;
                padding-right: 40px; /* Ajusta padding direito */
             }
             .announcement-card h4 {
                 padding-right: 15px;
             }

            .footer-content {
                flex-direction: column;
                text-align: center;
            }

            .footer-links {
                justify-content: center;
                margin-top: 10px;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo-container">
                <div class="logo">
                    <img src="https://media.licdn.com/dms/image/v2/D4D0BAQEVPuGbXNaO9g/company-logo_200_200/B4DZUjbqcxHYAM-/0/1740056209644/chavantes_logo?e=2147483647&v=beta&t=RR6W8OwoyPgZtbRcrlq7BIFPosXIEAFoAoePL65UKa4" alt="Logo Grupo Chavantes">
                </div>
                <div class="header-text">
                    <h1>Portal Interno</h1>
                    <p class="subtitle">Hospital Waldemar Tebaldi | Grupo Chavantes</p>
                </div>
            </div>
            <div class="user-info">
                <div class="user-avatar">JS</div> </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <section class="welcome-section">
                <h2 class="welcome-title">Bem-vindo ao Portal Corporativo</h2>
                <p class="welcome-text">
                    Acesse os serviços e ferramentas essenciais para o seu dia a dia no Hospital Waldemar Tebaldi.
                    Este portal foi desenvolvido para facilitar seus processos internos e manter você conectado com
                    as principais informações institucionais.
                </p>
            </section>

            <section class="announcements-section" id="announcements-section" style="display: none;"> <h3 class="section-title"><i class="fas fa-bullhorn"></i> Anúncios e Notificações</h3>
                <div id="announcements-container">
                    </div>
                <div class="announcement-pagination" id="announcement-pagination" style="display: none;"> <button id="prev-announcement" class="pagination-button" title="Anterior"><i class="fas fa-chevron-left"></i></button>
                    <span id="announcement-page-indicator"></span>
                    <button id="next-announcement" class="pagination-button" title="Próximo"><i class="fas fa-chevron-right"></i></button>
                </div>
            </section>
            <section class="services-section">
                <h3 class="section-title"><i class="fas fa-th-large"></i> Serviços Principais</h3>
                <div class="services-grid">
                     <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-concierge-bell"></i>
                        </div>
                        <div class="service-content">
                            <h4 class="service-title">Hotelaria e Refrigeração</h4>
                            <p class="service-description">Solicitações de serviços de hotelaria e manutenção de equipamentos de refrigeração.</p>
                            <a href="http://10.172.0.20:3001/hotelaria.html" class="service-link">Acessar</a>
                        </div>
                    </div>

                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-laptop-code"></i>
                        </div>
                        <div class="service-content">
                            <h4 class="service-title">Tecnologia e Informação</h4>
                            <p class="service-description">Suporte técnico e solicitações para o departamento de TI.</p>
                            <a href="http://10.172.0.20:3001/ti.html" class="service-link">Acessar</a>
                        </div>
                    </div>

                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-tools"></i>
                        </div>
                        <div class="service-content">
                            <h4 class="service-title">Manutenção Predial</h4>
                            <p class="service-description">Solicitação de serviços de manutenção e reparos na infraestrutura.</p>
                            <a href="http://10.172.0.20:3001/manutencao.html" class="service-link">Acessar</a>
                        </div>
                    </div>

                    <div class="service-card emergency">
                        <div class="service-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="service-content">
                            <h4 class="service-title">Notificação de Incidentes</h4>
                            <p class="service-description">Registro e consulta de incidentes.</p>
                            <a href="https://medalchemy.com.br/evenadv.html" class="service-link">Acessar</a>
                        </div>
                    </div>

                    <div class="service-card compliance">
                        <div class="service-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="service-content">
                            <h4 class="service-title">Canal de Compliance</h4>
                            <p class="service-description">Comunicação de questões éticas e de conformidade.</p>
                            <a href="https://forms.office.com/Pages/ResponsePage.aspx?id=zpcUiDXjFUm3XESJ0zo7Iq55wzZul6NLk8wUgLmIXpNUNFk2SVBMMEtSUjFRTEMwWTJQSDJDNkhTWS4u" class="service-link">Acessar</a>
                        </div>
                    </div>

                    <div class="service-card documents">
                        <div class="service-icon">
                            <i class="fas fa-folder-open"></i>
                        </div>
                        <div class="service-content">
                            <h4 class="service-title">Documentos Institucionais</h4>
                            <p class="service-description">Acesso aos manuais, políticas e procedimentos do hospital.</p>
                            <a href="https://santacasachavantes.sharepoint.com/:f:/s/intranet.hmamericana/ErAXO-pPxfhEur7BKko2YLQBrTlL_PbpwaZiHJ5Ejc8huQ?e=5nYSpT" class="service-link">Acessar</a>
                        </div>
                    </div>

                <div class="service-card Dashboards">
                    <div class="service-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <div class="service-content">
                        <h4 class="service-title">Indicadores Hospitalares</h4>
                        <p class="service-description">Acesso aos indicadores, monitoramento e gestão.</p>
                        <a href="https://medalchemy.com.br/dashboard.html" class="service-link">Acessar</a>
                    </div>
                </div>
            </div>
            </section>

            <section class="quick-links">
                <h3 class="section-title"><i class="fas fa-link"></i> Acesso Rápido</h3>
                <div class="links-grid">
                    <a href="https://hmamericana.local.conectew.com.br/" class="quick-link">
                        <i class="fas fa-cogs"></i>
                        <span>ERP Wareline</span>
                    </a>
                    <a href="https://forms.office.com/r/UwubVFrcPf" class="quick-link">
                        <i class="fas fa-lock"></i>
                        <span>Compra não padrão</span>
                    </a>
                    <a href="https://drive.google.com/file/d/1dRivHHmXzzKKUsmoMZWxKd6tMXYJ3wd7/view?usp=sharing" class="quick-link">
                        <i class="fas fa-info-circle"></i>
                        <span>Medicações padrão</span>
                    </a>
                    <a href="http://10.172.0.70/#/login" class="quick-link">
                        <i class="fas fa-radiation"></i>
                        <span>Raio X</span>
                    </a>
                    <a href="https://pacs.medilaudo.net/login" class="quick-link">
                        <i class="fas fa-brain"></i>
                        <span>Tomografia</span>
                    </a>
                     <a href="#" class="quick-link"> <i class="fas fa-calendar-alt"></i>
                        <span>Agenda</span>
                    </a>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <p class="footer-text">Portal Interno - HMA Grupo Chavantes &copy; <span class="current-year"></span></p>
            <div class="footer-links">
                <a href="#" class="footer-link">Política de Privacidade</a>
                <a href="#" class="footer-link">Termos de Uso</a>
                <a href="#" class="footer-link">Suporte</a>
            </div>
            <p class="footer-text">Desenvolvido por @Quincrafts &copy; <span class="current-year"></span></p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {

            // --- DADOS DOS ANÚNCIOS ---
            // Adicione seus anúncios aqui. Cada um é um objeto com id, titulo e conteudo (pode ser HTML).
            const announcementsData = [
               
             {
                    id: 'atualizacaoSistema',
                    titulo: '⚠️ Atualização Importante do Sistema WARELINE⚠️',
                    conteudo: `
                        <p>Informamos que o Sistema WARELINE passará por uma atualização essencial na próxima quarta-feira (07/05), das 22:00 às 23:00.</p>
                        <p>Durante este período, o sistema poderá apresentar instabilidade ou ficar temporariamente indisponível.</p>
                        <p class="urgent-contact">
                            🚨 Precisa de acesso? Consulte a T.I para ter acesso a versão em nuvem do sistema.
                        </p>
                        <p>Agradecemos a compreensão.</p>
                    `
                },

                // Adicione mais anúncios aqui conforme necessário
            ];

            // --- VARIÁVEIS GLOBAIS DO MÓDULO DE ANÚNCIOS ---
            let currentAnnouncementIndex = 0;
            let activeAnnouncements = [];
            let closedAnnouncements = [];

            // --- ELEMENTOS DO DOM ---
            const announcementsSection = document.getElementById('announcements-section');
            const container = document.getElementById('announcements-container');
            const paginationControls = document.getElementById('announcement-pagination');
            const prevButton = document.getElementById('prev-announcement');
            const nextButton = document.getElementById('next-announcement');
            const pageIndicator = document.getElementById('announcement-page-indicator');

            // --- FUNÇÕES ---

            // Carrega IDs dos anúncios fechados do localStorage
            function loadClosedAnnouncements() {
                try { // Adiciona try-catch para segurança com localStorage
                    closedAnnouncements = JSON.parse(localStorage.getItem('closedAnnouncements_hmamericana') || '[]');
                    if (!Array.isArray(closedAnnouncements)) { // Garante que seja um array
                         closedAnnouncements = [];
                    }
                } catch (e) {
                    console.error("Erro ao carregar anúncios fechados:", e);
                    closedAnnouncements = [];
                }
            }

            // Salva IDs dos anúncios fechados no localStorage
            function saveClosedAnnouncements() {
                 try {
                     localStorage.setItem('closedAnnouncements_hmamericana', JSON.stringify(closedAnnouncements));
                 } catch (e) {
                      console.error("Erro ao salvar anúncios fechados:", e);
                 }
            }

            // Filtra os anúncios que ainda não foram fechados
            function filterActiveAnnouncements() {
                activeAnnouncements = announcementsData.filter(announcement => !closedAnnouncements.includes(announcement.id));
            }

            // Exibe o anúncio no índice especificado
            function displayAnnouncement(index) {
                if (!container || index < 0 || index >= activeAnnouncements.length) {
                    if (container) container.innerHTML = '';
                    if(announcementsSection) announcementsSection.style.display = 'none';
                    return;
                }

                const announcement = activeAnnouncements[index];
                // Remove a animação antiga antes de adicionar o novo conteúdo
                if (container.firstElementChild) {
                    container.firstElementChild.style.animation = 'none';
                }
                container.innerHTML = `
                    <div class="announcement-card" data-id="${announcement.id}">
                        <button class="close-announcement" title="Fechar anúncio">&times;</button>
                        <h4>${announcement.titulo}</h4>
                        ${announcement.conteudo}
                    </div>
                `;
                 // Força reflow para reiniciar a animação (opcional)
                // void container.offsetWidth;
                if (container.firstElementChild) {
                    container.firstElementChild.style.animation = 'fadeIn 0.4s ease-out';
                }


                const closeButton = container.querySelector('.close-announcement');
                if (closeButton) {
                    closeButton.addEventListener('click', () => closeAnnouncement(announcement.id));
                }

                if(announcementsSection) announcementsSection.style.display = 'block';
                updatePaginationControls();
            }

            // Atualiza a visibilidade e estado dos controles de paginação
            function updatePaginationControls() {
                 if (!paginationControls || !pageIndicator || !prevButton || !nextButton) return;

                const totalActive = activeAnnouncements.length;

                if (totalActive <= 1) {
                    paginationControls.style.display = 'none';
                } else {
                    paginationControls.style.display = 'flex';
                    pageIndicator.textContent = `${currentAnnouncementIndex + 1} / ${totalActive}`;
                    prevButton.disabled = currentAnnouncementIndex === 0;
                    nextButton.disabled = currentAnnouncementIndex === totalActive - 1;
                }
            }

            // Função para fechar um anúncio específico
            function closeAnnouncement(id) {
                if (!closedAnnouncements.includes(id)) {
                    closedAnnouncements.push(id);
                    saveClosedAnnouncements();
                    filterActiveAnnouncements();

                    if (currentAnnouncementIndex >= activeAnnouncements.length) {
                        currentAnnouncementIndex = Math.max(0, activeAnnouncements.length - 1);
                    }

                    if (activeAnnouncements.length > 0) {
                        displayAnnouncement(currentAnnouncementIndex);
                    } else {
                        if(container) container.innerHTML = '';
                        if(paginationControls) paginationControls.style.display = 'none';
                        if(announcementsSection) announcementsSection.style.display = 'none';
                    }
                }
            }

            // Navega para o próximo anúncio
            function showNextAnnouncement() {
                if (currentAnnouncementIndex < activeAnnouncements.length - 1) {
                    currentAnnouncementIndex++;
                    displayAnnouncement(currentAnnouncementIndex);
                }
            }

            // Navega para o anúncio anterior
            function showPrevAnnouncement() {
                if (currentAnnouncementIndex > 0) {
                    currentAnnouncementIndex--;
                    displayAnnouncement(currentAnnouncementIndex);
                }
            }

            // Inicializa o sistema de anúncios
            function initAnnouncements() {
                // Verifica se os elementos necessários existem antes de prosseguir
                 if (!announcementsSection || !container || !paginationControls || !prevButton || !nextButton || !pageIndicator) {
                    console.warn("Elementos HTML dos anúncios não encontrados. Sistema de anúncios desativado.");
                    return; // Interrompe a inicialização se faltar algum elemento crucial
                }

                loadClosedAnnouncements();
                filterActiveAnnouncements();

                if (activeAnnouncements.length > 0) {
                    currentAnnouncementIndex = 0;
                    displayAnnouncement(currentAnnouncementIndex); // Exibe o primeiro antes de adicionar listeners
                    prevButton.addEventListener('click', showPrevAnnouncement);
                    nextButton.addEventListener('click', showNextAnnouncement);
                } else {
                     announcementsSection.style.display = 'none';
                }
            }

            // --- EXECUÇÃO INICIAL ---
            initAnnouncements(); // Inicia o sistema de anúncios


            // --- OUTROS SCRIPTS (mantidos) ---

            // Atualiza o ano atual no footer
            document.querySelectorAll('.current-year').forEach(el => {
                 try { // Adiciona verificação se o elemento existe
                    el.textContent = new Date().getFullYear();
                 } catch(e) { console.warn("Elemento .current-year não encontrado ou erro ao definir ano.") }
            });

            // Simulação de dados do usuário
            const userInitials = 'JS'; // Iniciais do usuário - Altere conforme necessário
            const userAvatar = document.querySelector('.user-avatar');
            if(userAvatar) userAvatar.textContent = userInitials;

            // Adiciona efeito de carregamento suave
            setTimeout(function() {
                document.body.style.opacity = '1';
            }, 50);

            // Adiciona target="_blank" para links externos (exceto os .local)
            document.querySelectorAll('a').forEach(link => {
                try {
                    const href = link.getAttribute('href');
                    // Verifica se href existe e é uma string antes de chamar métodos de string
                    if (href && typeof href === 'string') {
                         if ((href.startsWith('http:') || href.startsWith('https://')) && !href.includes('.local.')) {
                            if (!link.getAttribute('target')) {
                                 link.setAttribute('target', '_blank');
                                 link.setAttribute('rel', 'noopener noreferrer');
                            }
                        }
                    }
                } catch (e) {
                     console.warn("Erro ao processar link:", link, e);
                }
            });

        }); // Fim do DOMContentLoaded

    </script>
</body>
</html>
